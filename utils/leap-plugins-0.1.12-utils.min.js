/* 
 * LeapJS-Plugins Extra - v0.1.12 - 2017-10-18 
 * http://github.com/leapmotion/leapjs-plugins/ 
 * 
 * Copyright 2017 LeapMotion, Inc 
 * 
 * Licensed under the Apache License, Version 2.0 (the "License"); 
 * you may not use this file except in compliance with the License. 
 * You may obtain a copy of the License at 
 * 
 *     http://www.apache.org/licenses/LICENSE-2.0 
 * 
 * Unless required by applicable law or agreed to in writing, software 
 * distributed under the License is distributed on an "AS IS" BASIS, 
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied. 
 * See the License for the specific language governing permissions and 
 * limitations under the License. 
 * 
 */

!function(t,i){"function"==typeof define&&define.amd?define([],i):t.LeapDataPlotter=i()}(this,function(){var t,i,e=["#900","#090","#009","#990","#909","#099"],s=0;return t=function(t){this.options=t||(t={}),this.seriesHash={},this.series=[],this.init(t.el)},t.prototype.init=function(t){if(t)var i=t;else(i=document.createElement("canvas")).className="leap-data-plotter",document.body.appendChild(i);this.canvas=i,this.context=i.getContext("2d"),this.rescale()},t.prototype.rescale=function(){var t=getComputedStyle(this.canvas),i=parseInt(t.width,10),e=parseInt(t.height,10);this.width=i,this.height=e;var s=window.devicePixelRatio||1,h=this.context.webkitBackingStorePixelRatio||this.context.mozBackingStorePixelRatio||this.context.msBackingStorePixelRatio||this.context.oBackingStorePixelRatio||this.context.backingStorePixelRatio||1,o=s/h;if(s!==h){var n=this.canvas.width,r=this.canvas.height;this.canvas.width=n*o,this.canvas.height=r*o,this.canvas.style.width=n+"px",this.canvas.style.height=r+"px",this.context.scale(o,o)}this.clear(),this.draw()},t.prototype.plot=function(t,i,e){if(e||(e={}),i.length)for(var s=0,h=120;s<i.length;s++,h=++h>122?97:h)this.getTimeSeries(t+"."+String.fromCharCode(h),e).push(i[s],{pointColor:e.pointColor});else this.getTimeSeries(t,e).push(i,{pointColor:e.pointColor})},t.prototype.getTimeSeries=function(t,e){var s=this.seriesHash[t];if(!s){var h=this.getOptions(t);for(key in e)h[key]=e[key];s=new i(h),this.series.push(s),this.seriesHash[t]=s}return s},t.prototype.getOptions=function(t){var i=s;s=(s+1)%e.length;var h=this.series.length;return{y:h?this.series[h-1].y+50:0,width:this.width,color:e[i],name:t}},t.prototype.clear=function(){this.context.clearRect(0,0,this.width,this.height)},t.prototype.draw=function(){var t=this.context;this.series.forEach(function(i){i.draw(t)})},t.prototype.update=function(){this.clear(),this.draw()},i=function(t){t=t||{},this.x=t.x||0,this.y=t.y||0,this.precision=t.precision||5,this.units=t.units||"",this.width=t.width||1e3,this.height=t.height||50,this.length=t.length||600,this.color=t.color||"#000",this.name=t.name||"",this.frameHandler=t.frameHandler,this.max=-1/0,this.min=1/0,this.data=[],this.pointColors=[]},i.prototype.push=function(t,i){return this.data.push(t),this.data.length>=this.length&&this.data.shift(),i&&i.pointColor&&(this.pointColors.push(i.pointColor),this.pointColors.length>=this.length&&this.pointColors.shift()),this},i.prototype.draw=function(t){var i=this,e=(this.width-10)/(this.length-1),s=-(this.height-10)/(this.max-this.min),h=(this.max-this.min)*s+10;t.save(),t.strokeRect(this.x,this.y,this.width,this.height),t.translate(this.x,this.y+this.height-5),t.strokeStyle=this.color,t.beginPath();var o=-1/0,n=1/0;this.data.forEach(function(h,r){h>o&&(o=h),h<n&&(n=h),isNaN(h)?(t.stroke(),t.beginPath()):(t.lineTo(r*e,(h-i.min)*s),i.pointColors[r]&&i.pointColors[r]!=i.pointColors[r-1]&&(t.stroke(),t.strokeStyle=i.pointColors[r],t.beginPath(),t.lineTo(r*e,(h-i.min)*s)))}),t.stroke(),t.fillText(this.name,5,h),t.fillText(this.data[this.data.length-1].toPrecision(this.precision)+this.units,5,0),t.textAlign="end",t.fillText(this.min.toPrecision(this.precision)+this.units,this.width-5,0),t.fillText(this.max.toPrecision(this.precision)+this.units,this.width-5,h),t.textAlign="left",t.restore(),this.min=n,this.max=o},t});